<%=render :partial => "shared/header_container"%>
<div id="breadcrumb">
    <a href="#" title="Go to Home" class="tip-bottom"><i class="icon-home"></i> Home</a>
    <%= link_to 'Projects', projects_path, :class => "current"  %>
</div>


<div class="container-fluid">
  <div class="row-fluid">
    <div class="span12">
      <div class="widget-box">
        <div class="widget-title">
          <span class="icon">
          <i class="icon-th"></i>
          </span>
          <h5>Project Name: <%=@project.name%></h5>
          <div class="buttons">
            <span style="margin-right:5px;">
              Private API Key:
            </span>

            <span class="label"><%= @project.key.to_s%></span>
          </div>
        </div>
        <div class="widget-content">
          <div id="settings">
            <div class="tabbable tabs-left">
              <ul class="nav nav-tabs">
                <li class="active">
                  <a data-toggle="tab" href="#tab-collaborators">Collaborators</a>
                </li>
                <li class="">
                  <a data-toggle="tab" href="#tab-install">Setup</a>
                </li>
                <!--<li class="">
                  <a data-toggle="tab" href="#tab-notifications">Notifications</a>
                </li>-->
                <!--<li class="">
                  <a data-toggle="tab" href="#tab-edit">Edit</a>
                </li>-->
                <li class="">
                  <a data-toggle="tab" href="#tab-campfire">Campfire</a>
                </li>
                <li class="">
                  <a data-toggle="tab" href="#tab-pivotal">Pivotal Tracker</a>
                </li>
                <li class="">
                  <a data-toggle="tab" href="#tab-flowdock">Flowdock</a>
                </li>
                <li class="">
                  <a data-toggle="tab" href="#tab-hipchat">HipChat</a>
                </li>
                <li class="">
                  <a data-toggle="tab" href="#tab-delete">Delete</a>
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane" id="tab-install">
                  <ul class="nav nav-pills">
                    <li class="active">
                      <a data-toggle="pill" href="#tab-install-rails3">Rails 3</a>
                    </li>
                   </ul>
                  <div class="tab-content">
                    <div class="tab-pane active" id="tab-install-rails3">
                      <h2>Rails 3 Installation</h2>
                      <p>Add the Honeybadger gem to your gemfile:</p>
                      <pre>gem 'batbugger'</pre>
                      <p>Install the gem:</p>
                      <pre>bundle install</pre>
                      <p>Also please create the initializer, that's simple enough. Just put the code below in config/initializers/batbugger.rb</p>
                      <pre>Batbugger.configure do |config|
  config.api_key = '<%= @project.key.to_s%>'  #[your-api-key]
  config.secure = false
  config.environment_name = 'production'  #[rails-env]
end</pre>
                      <p>URL:</p>
                      <pre><i class="icon-hand-right"></i> <%= link_to "BatBugger-Github: https://github.com/grepruby/batbugger", "https://github.com/grepruby/batbugger", :target=>"_blank"%></pre>
                    </div>
                  </div>
                </div>
                <!--<div class="tab-pane" id="tab-notifications">
                  <h2>Notification Settings</h2>
                  <form accept-charset="UTF-8" action="/projects/1427/watchers/3056" class="simple_form form-horizontal edit-watcher" data-remote="true" data-success="Your notification preferences have been updated." id="edit_watcher_3056" method="post" novalidate="novalidate">
                    <div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="✓"><input name="_method" type="hidden" value="put"><input name="authenticity_token" type="hidden" value="RDTlqC/wiGpCfLZrPJLvAPY5OZ93p7AO5Iy3WaX+wRA="></div>
                    <div class="control-group email optional">
                      <label class="email optional control-label" for="watcher_notification_email">Email address</label>
                      <div class="controls"><input class="string email optional" id="watcher_notification_email" name="watcher[notification_email]" size="50" type="email" value="asharma.rubyonrails@gmail.com"></div>
                    </div>
                    <div class="control-group">
                      <div class="controls">
                        <label class="checkbox" for="watcher_email"><input name="watcher[email]" type="hidden" value="0"><input checked="checked" id="watcher_email" name="watcher[email]" type="checkbox" value="1">
                        Send notifications via email
                        </label>
                      </div>
                    </div>
                    <div class="control-group string optional">
                      <label class="string optional control-label" for="watcher_notification_cell">Cell phone</label>
                      <div class="controls"><input class="string optional" id="watcher_notification_cell" name="watcher[notification_cell]" size="50" type="text"></div>
                    </div>
                    <div class="control-group">
                      <div class="controls">
                        <label class="checkbox" for="watcher_sms"><input name="watcher[sms]" type="hidden" value="0"><input id="watcher_sms" name="watcher[sms]" type="checkbox" value="1">
                        Send notifications via SMS
                        </label>
                      </div>
                    </div>
                    <div class="control-group">
                      <div class="controls">
                        <label class="checkbox" for="watcher_daily_digest"><input name="watcher[daily_digest]" type="hidden" value="0"><input id="watcher_daily_digest" name="watcher[daily_digest]" type="checkbox" value="1">
                        Include in daily digest emails
                        </label>
                      </div>
                    </div>
                    <div class="control-group">
                      <div class="controls">
                        <label class="checkbox" for="watcher_weekly_digest"><input name="watcher[weekly_digest]" type="hidden" value="0"><input checked="checked" id="watcher_weekly_digest" name="watcher[weekly_digest]" type="checkbox" value="1">
                        Include in weekly digest emails
                        </label>
                      </div>
                    </div>
                    <div class="form-actions">
                      <input class="btn btn-primary" type="submit" value="Save">
                    </div>
                  </form>
                </div>-->
                <div class="tab-pane active" id="tab-collaborators">
                  <h2>Collaborators</h2>
                  <p id="invitation_response"></p>
                  <div id="collaborator_list" class="span5" style="margin-left:0px;">
                    <table class="table table-striped table-bordered">
                      <thead>
                        <tr>
                          <th>Email</th>
                          <th>Status</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% @project.user_projects.each do |user_project|%>
                          <tr>
                            <td class="taskDesc"><%=user_project.user.email%></td>
                            <td class="taskStatus">
                              <% if user_project.status %>
                                <span class="label label-success"> active </span>
                              <% else %>
                                <span class="label label-warning"> pending </span>
                              <% end %>
                            </td>
                          </tr>
                        <% end %>
                      </tbody>
                    </table>
                  </div>
                  <div class="clearfix ">&nbsp;</div>
                  <div>
                  <h3>Invite a new collaborator</h3>
                  <p></p>
                  <form accept-charset="UTF-8" id="invitation_form" action="<%= invitation_project_path(@project)%>" class="simple_form form-horizontal" data-remote="true" id="new_invitation" method="post" novalidate="novalidate">
                    <div style="margin:0;padding:0;display:inline"></div>
                    <div class="control-group">
                      <label class="required control-label">Email</label>
                      <div class="controls">
                        <input id="invitation_email" class="required email" name="invitation[email]" placeholder="Email" size="30" type="email">
                      </div>
                    </div>
                    <!--<div class="control-group">
                      <label class="required control-label">Project Permissions</label>
                      <div class="controls">
                        <select id="invitation_admin" name="invitation[admin]">
                          <option value="false" selected="selected">Normal User</option>
                          <option value="true">Admin User</option>
                        </select>
                        <span class="help-block">
                        Admin users can do anything to a project you can do aside from delete it
                        </span>
                      </div>
                    </div>-->
                    <div class="form-actions">
                      <input id="invitation_submit" class="btn btn-primary" type="submit" value="Send Invitation">
                    </div>
                  </form>
                  <p></p>
                </div>
                </div>
                <!--<div class="tab-pane" id="tab-edit">
                  <h2>Project settings</h2>
                  <p>comming soon...</p>
                </div>-->
                <div class="tab-pane" id="tab-campfire">
                  <h2>Campfire settings</h2>
                  <div id="campfire_area"></div>
                  <% if @project.campfire_subdomain.blank? %>
                    <form accept-charset="UTF-8" action="<%= campfire_authenticate_project_path(@project)%>" class="simple_form form-horizontal" data-remote="true" id="campfire_authenticate" method="post" novalidate="novalidate">
                      <div class="control-group required string">
                        <label class="control-label required string">
                          <abbr title="required">*</abbr>
                          Subdomain
                        </label>
                        <div class="controls">
                          <input class="string required" name="campfire[campfire_subdomain]" type="text" value="">
                        </div>
                      </div>
                      <div class="control-group required string">
                        <label class="control-label required string">
                          <abbr title="required">*</abbr>
                          Room
                        </label>
                        <div class="controls">
                          <input class="string required" name="campfire[campfire_room]" type="text" value="">
                        </div>
                      </div>
                      <div class="control-group required string">
                        <label class="control-label required string">
                          <abbr title="required">*</abbr>
                          Token
                        </label>
                        <div class="controls">
                          <input class="string required" name="campfire[campfire_token]" type="text" value="">
                        </div>
                      </div>
                      <!--<div class="control-group">
                        <div class="controls">
                          <label class="checkbox" for="campfire_activate"><input name="campfire[campfire_activate]" type="hidden" value="0"><input checked="checked" id="12153500_watch_active" name="campfire[campfire_activate]" type="checkbox" value="1">
                            Activate
                          </label>
                        </div>
                      </div>-->
                      <div class="form-actions">
                        <input class="btn btn-primary" type="submit" value="Save">
                      </div>
                    </form>
                  <% else %>
                    <div id="campfire_detail">
                      <div>Subdomain : <%= @project.campfire_subdomain %></div>
                      <div>Campfire room url: <a target="blank" href="https://<%= @project.campfire_subdomain %>.campfirenow.com/room/<%= @project.campfire_room_id %>">Click here</a></div>
                      <div>Token : <%= @project.campfire_token %></div>
                      <div>Room name : <%= @project.campfire_room %></div>
                      <div style="clear:both;">&nbsp</div>
                      <%= link_to "Delete settings", campfire_delete_project_path(@project), :remote => true, :method => :delete, :class => "btn" %>
                      <%= link_to "Edit settings", campfire_detail_project_path(@project), :remote => true, :method => :get, :class => "btn", :style => "margin-left:20px;" %>
                    </div>
                  <% end %>
                </div>
                <div class="tab-pane" id="tab-pivotal">
                  <h2>Pivotal settings</h2>
                  <div id="pivotal_projects"></div>
                  <% if @project.pivotal_token.blank? %>
                    <a id="modal_anchor" href="#myModal" role="button" class="btn" data-toggle="modal">Authenticate</a>
                  <% else %>
                    <% if @project.pivotal_project_id.blank?%>
                      <form accept-charset="UTF-8" action="<%= pivotal_project_path(@project)%>" class="simple_form form-horizontal" data-remote="true" id="pivotal" method="post" novalidate="novalidate">
                        <div>
                          <select id="pivotal_project" name="pivotal_project_id">
                            <% @pivotal_projects.each do |project| %>
                              <option value="<%= project.id %>"><%= project.name %></option>
                            <% end %>
                          </select>
                          <input class="btn btn-primary btn" name="commit" type="submit" value="Save" style="margin-left:20px;" onclick="$('#spin').show();">
                          <img src="/assets/spinner.gif" class="hide" id="spin"/>
                        </div>
                      </form>
                    <% else %>
                      <div id="pivotal_detail">
                        <div>Registered Project : <%= @project.pivotal_project_name %></div>
                        <div>Project url: <a target="blank" href="https://www.pivotaltracker.com/projects/<%= @project.pivotal_project_id %>">Click here</a></div>
                        <div style="clear:both;">&nbsp</div>
                        <%= link_to "Delete settings", pivotal_delete_project_path(@project), :remote => true, :method => :delete, :class => "btn" %>
                        <%= link_to "Edit settings", pivotal_detail_project_path(@project), :remote => true, :method => :get, :class => "btn", :style => "margin-left:20px;" %>
                      </div>
                    <% end %>
                  <% end %>
                  <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                      <h3 id="myModalLabel">Pivotal Authentication Form</h3>
                    </div>
                    <form accept-charset="UTF-8" action="<%= pivotal_authenticate_project_path(@project)%>" class="simple_form form-horizontal" data-remote="true" id="pivotal_authenticate" method="post" novalidate="novalidate">
                      <div class="modal-body">
                        <p>We are not going to save your email or password.</p>
                        <div style="margin:0;padding:0;display:inline"></div>
                        <div class="control-group">
                          <label class="required control-label">Username/Email</label>
                          <div class="controls">
                            <input id="authenticate_email" name="authenticate[email]" placeholder="Email" size="30" type="email">
                          </div>
                          <label class="required control-label">Password</label>
                          <div class="controls">
                            <input id="authenticate_password" name="authenticate[password]" placeholder="Password" size="30" type="password">
                          </div>
                        </div>
                      </div>
                      <div class="modal-footer">
                        <img src="/assets/spin.gif" class="hide" id="spinner"/>
                        <input id="modal_submit" class="btn btn-primary btn" name="commit" type="submit" value="Save" onclick="$('#spinner').show();$(this).attr('disabled', 'disabled');">
                        <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
                      </div>
                    </form>
                  </div>
                </div>
                <div class="tab-pane" id="tab-flowdock">
                  <h2>Flowdock settings</h2>
                  <p>comming soon...</p>
                </div>
                <div class="tab-pane" id="tab-hipchat">
                  <h2>HipChat settings</h2>
                  <p>comming soon...</p>
                </div>
                <div class="tab-pane" id="tab-delete">
                  <h2>Delete project</h2>
                  <p style="text-align: center;">
                    <strong>WARNING:</strong>
                    Deleting this project will cause all of its associated data to be deleted immediately.
                  </p>
                  <p style="text-align: center; color: #DA4E49;">
                    <strong>This action can not be undone.</strong>
                  </p>
                  <p style="text-align: center;">
                    <%= link_to @project, confirm: 'Are you sure?', method: :delete , class: "btn btn-large" do %>
                      I understand — Delete this project and its data
                    <% end %>
                  </p>
                  <p class="hidden" id="delete-project-button" style="text-align: center;">
                    <a href="/projects/1427" class="btn btn-danger btn-large" data-confirm="Last chance... The Badger does not lie." data-method="delete" rel="nofollow">For realz?</a>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
